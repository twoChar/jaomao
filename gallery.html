<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Memories | Party Edition</title>

    <!-- React & ReactDOM -->
    <script
      crossorigin
      src="https://unpkg.com/react@18/umd/react.development.js"
    ></script>
    <script
      crossorigin
      src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"
    ></script>

    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Framer Motion -->
    <script src="https://unpkg.com/framer-motion@10.16.4/dist/framer-motion.js"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css2?family=Outfit:wght@200;300;400;500;700&family=Playfair+Display:ital,wght@0,400;0,600;1,400&display=swap"
      rel="stylesheet"
    />

    <style>
      body {
        font-family: "Outfit", sans-serif;
        background-color: #050505;
        color: #ffffff;
        overflow-x: hidden;
        cursor: none;
      }

      /* Hide Scrollbar */
      ::-webkit-scrollbar {
        width: 0px;
        background: transparent;
      }

      .custom-cursor {
        pointer-events: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 12px;
        height: 12px;
        border-radius: 50%;
        background-color: white;
        transform: translate(-50%, -50%);
        z-index: 9999;
        mix-blend-mode: exclusion;
        transition: width 0.2s, height 0.2s;
      }

      .custom-cursor-follower {
        pointer-events: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 40px;
        height: 40px;
        border-radius: 50%;
        border: 1px solid rgba(255, 255, 255, 0.2);
        transform: translate(-50%, -50%);
        z-index: 9998;
        transition: all 0.1s ease-out;
      }

      .grain-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 9000;
        opacity: 0.03;
        background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.9' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)'/%3E%3C/svg%3E");
      }

      .serif {
        font-family: "Playfair Display", serif;
      }

      /* Smooth scrolling container */
      #smooth-wrapper {
        width: 100%;
        overflow: hidden;
      }
    </style>

    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              dark: {
                bg: "#050505",
                card: "#121212",
                border: "#2A2A2A",
              },
              gold: {
                500: "#D4AF37",
                400: "#F4CF57",
              },
            },
            backgroundImage: {
              "gradient-radial": "radial-gradient(var(--tw-gradient-stops))",
            },
          },
        },
      };
    </script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel">
      const {
        useState,
        useEffect,
        useRef,
        useMemo,
        createContext,
        useContext,
      } = React;
      const {
        motion,
        useScroll,
        useTransform,
        useSpring,
        useMotionValue,
        useVelocity,
        useAnimationFrame,
        AnimatePresence,
      } = window.Motion;

      // --- Data Configuration ---
      const BASE_PATH = "./";

      const RAW_FILE_LIST = [
        "Screenshot 2025-08-27 at 20.27.05.png",
        "hbd24.PNG",
        "a1.MP4",
        "a2.MP4",
        "a3.MP4",
        "a4.MOV",
        "hbd25.MOV",
        "h1.png",
        "h2.png",
        "h3.jpg",
        "h4.jpg",
        "h5.png",
        "h6.png",
        "h7.jpg",
        "h8.PNG",
        "h9.PNG",
        "hbd1.jpg",
        "hbd2.png",
        "hbd3.JPG",
        "hbd4.JPG",
        "hbd5.JPG",
        "hbd6.jpg",
        "hbd7.JPG",
        "hbd8.JPG",
        "hbd9.jpg",
        "hbd11.jpg",
        "hbd13.jpg",
        "hbd14.jpg",
        "hbd15.jpg",
        "hbd17.jpg",
        "hbd18.jpg",
        "hbd19.jpg",
        "hbd20.jpg",
        "hbd21.jpg",
        "hbd22.jpg",
        "hbd23.jpg",
        "hbd26.jpg",
        "hbd27.jpg",
        "hbd28.jpg",
        "hbd29.jpg",
        "hbd30.jpg",
        "hbd31.jpg",
        "hbd32.jpg",
        "hbd33.jpg",
        "hbd34.jpg",
        "hbd35.jpg",
        "hbd36.jpg",
        "hbd37.jpg",
        "hbd38.jpg",
        "hbd39.jpg",
        "hbd40.jpg",
        "hbd44.jpg",
        "hbd45.jpg",
        "hbd46.jpg",
        "hbd47.jpg",
        "hbd48.jpg",
        "hbd49.jpg",
        "hbd50.jpg",
        "hbd51.jpg",
        "hbd52.jpg",
        "hbd53.jpg",
        "hbd54.jpg",
        "hbd55.jpg",
        "hbd56.jpg",
        "hbd57.jpg",
        "hbd58.jpg",
        "hbd59.jpg",
        "IMG_0256.jpg",
        "IMG_0654.jpg",
        "IMG_0662.jpg",
        "IMG_0757.jpg",
        "IMG_0864.jpg",
        "IMG_1102 (1).jpg",
        "IMG_1391.JPG",
        "IMG_2556.jpg",
        "IMG_2559.jpg",
        "IMG_3383.JPG",
        "IMG_3384.JPG",
        "IMG_3385.JPG",
        "IMG_4609.JPG",
        "IMG_4610.JPG",
        "IMG_4611.JPG",
        "IMG_4613.JPG",
        "IMG_4614.JPG",
        "IMG_4615.JPG",
        "IMG_4617.JPG",
        "IMG_4618.JPG",
        "IMG_4619.JPG",
        "IMG_4621 2.JPG",
        "IMG_4621.JPG",
        "IMG_4622.JPG",
        "IMG_4623.JPG",
        "IMG_4624.JPG",
        "IMG_4625.JPG",
        "IMG_4626.JPG",
        "IMG_4627.JPG",
        "IMG_4629.JPG",
        "IMG_4630.JPG",
        "IMG_4631.JPG",
        "IMG_4632.JPG",
      ];

      const GalleryContext = createContext({
        hideBroken: false,
        setHideBroken: () => {},
      });

      const shuffleArray = (array) => {
        let currentIndex = array.length,
          randomIndex;
        while (currentIndex != 0) {
          randomIndex = Math.floor(Math.random() * currentIndex);
          currentIndex--;
          [array[currentIndex], array[randomIndex]] = [
            array[randomIndex],
            array[currentIndex],
          ];
        }
        return array;
      };

      const generateMediaItems = () => {
        const uniqueList = [...new Set(RAW_FILE_LIST)];
        const shuffledList = shuffleArray(uniqueList);

        return shuffledList.map((filename, i) => {
          const lowerName = filename.toLowerCase();
          const isVideo =
            lowerName.endsWith(".mp4") || lowerName.endsWith(".mov");

          // Assign random "Personality" to each block
          const personalityType = Math.random();
          let behavior = "float"; // Default
          if (personalityType > 0.8) behavior = "spin";
          else if (personalityType > 0.6) behavior = "wobble";

          return {
            id: i,
            type: isVideo ? "video" : "image",
            src: `${BASE_PATH}${filename}`,
            filename: filename,
            behavior: behavior,
            // Random float parameters
            floatDuration: 3 + Math.random() * 4,
            rotationRange: Math.random() * 10 - 5,
            floatY: Math.random() * 20 - 10,
          };
        });
      };

      const ITEMS = generateMediaItems();

      // --- Components ---

      const CustomCursor = () => {
        const cursorRef = useRef(null);
        const followerRef = useRef(null);

        useEffect(() => {
          const moveCursor = (e) => {
            if (cursorRef.current && followerRef.current) {
              cursorRef.current.style.left = `${e.clientX}px`;
              cursorRef.current.style.top = `${e.clientY}px`;

              // Follower delay
              setTimeout(() => {
                if (followerRef.current) {
                  followerRef.current.style.left = `${e.clientX}px`;
                  followerRef.current.style.top = `${e.clientY}px`;
                }
              }, 50);
            }
          };
          window.addEventListener("mousemove", moveCursor);
          return () => window.removeEventListener("mousemove", moveCursor);
        }, []);

        return (
          <>
            <div ref={cursorRef} className="custom-cursor hidden md:block" />
            <div
              ref={followerRef}
              className="custom-cursor-follower hidden md:block"
            />
          </>
        );
      };

      const InfiniteMarquee = ({ items, direction = 1, speed = 0.5 }) => {
        const { scrollY } = useScroll();
        const scrollVelocity = useVelocity(scrollY);
        const baseX = useMotionValue(0);

        useAnimationFrame((t, delta) => {
          let moveBy = direction * speed * (delta / 1000) * 100;
          const velocityFactor = scrollVelocity.get() * 0.02; // More responsive velocity
          if (velocityFactor !== 0) {
            moveBy += velocityFactor * direction;
          }
          baseX.set(baseX.get() + moveBy);
        });

        const x = useTransform(
          baseX,
          (v) => `${(v % 100) - (direction > 0 ? 100 : 0)}%`
        );

        // Elastic skew effect
        const skewVelocity = useSpring(scrollVelocity, {
          stiffness: 200,
          damping: 20,
        });
        const skew = useTransform(skewVelocity, [-1000, 1000], [-10, 10]);
        const scale = useTransform(
          skewVelocity,
          [-1000, 0, 1000],
          [0.95, 1, 0.95]
        );

        return (
          <div className="w-full overflow-hidden flex py-6 relative z-10">
            <motion.div
              className="flex gap-8 w-max"
              style={{ x, skewX: skew, scale }}
            >
              {[...items, ...items].map((item, i) => (
                <MarqueeItem key={i} item={item} />
              ))}
            </motion.div>
          </div>
        );
      };

      const MarqueeItem = ({ item }) => {
        return (
          <motion.div
            className="relative w-[300px] h-[220px] md:w-[450px] md:h-[320px] flex-shrink-0 rounded-2xl overflow-hidden border border-white/10 bg-dark-card"
            whileHover={{
              scale: 1.05,
              rotate: Math.random() * 4 - 2,
              zIndex: 50,
              boxShadow: "0 0 40px rgba(212, 175, 55, 0.2)",
              border: "1px solid rgba(212, 175, 55, 0.5)",
            }}
            transition={{ type: "spring", stiffness: 300 }}
          >
            {item.type === "video" ? (
              <video
                src={item.src}
                className="w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-500"
                autoPlay
                loop
                muted
                playsInline
                onError={(e) => (e.target.style.display = "none")}
              />
            ) : (
              <img
                src={item.src}
                className="w-full h-full object-cover grayscale hover:grayscale-0 transition-all duration-500"
                alt={item.filename}
                loading="lazy"
                onError={(e) => (e.target.style.display = "none")}
              />
            )}
          </motion.div>
        );
      };

      const MediaItem = ({ item, isSpecial }) => {
        const { hideBroken } = useContext(GalleryContext);
        const [hasError, setHasError] = useState(false);
        const [isSpinning, setIsSpinning] = useState(false);

        // Randomly trigger spins for 'spin' behavior types
        useEffect(() => {
          if (item.behavior === "spin" && !isSpecial) {
            const interval = setInterval(() => {
              if (Math.random() > 0.7) {
                // 30% chance every cycle
                setIsSpinning(true);
                setTimeout(() => setIsSpinning(false), 1000);
              }
            }, Math.random() * 5000 + 5000); // Check every 5-10s
            return () => clearInterval(interval);
          }
        }, []);

        // Asteroid Floating Animation
        const floatVariants = {
          float: {
            y: [0, item.floatY, 0],
            rotate: [
              item.rotationRange,
              -item.rotationRange,
              item.rotationRange,
            ],
            transition: {
              duration: item.floatDuration,
              repeat: Infinity,
              ease: "easeInOut",
            },
          },
          spin: {
            rotate: 360,
            scale: [1, 1.1, 1],
            transition: { duration: 0.8, ease: "backOut" },
          },
        };

        if (hideBroken && hasError) return null;

        return (
          <motion.div
            className={`relative mb-8 break-inside-avoid ${
              isSpecial ? "z-20 w-full" : ""
            }`}
            initial={{ opacity: 0, scale: 0.8 }}
            whileInView={{ opacity: 1, scale: 1 }}
            viewport={{ once: true, margin: "50px" }}
            transition={{ duration: 0.6 }}
          >
            <motion.div
              className={`w-full rounded-2xl overflow-hidden bg-dark-card border shadow-xl relative transform-gpu ${
                isSpecial
                  ? "border-gold-500/50 shadow-gold-500/30"
                  : "border-white/5"
              }`}
              variants={floatVariants}
              animate={isSpinning ? "spin" : isSpecial ? {} : "float"}
              whileHover={{
                scale: 1.05,
                rotate: 0,
                y: 0,
                zIndex: 50,
                boxShadow: isSpecial
                  ? "0 0 60px rgba(212, 175, 55, 0.5)"
                  : "0 0 40px rgba(255, 255, 255, 0.2)",
                filter: "brightness(1.1)",
              }}
              transition={{
                scale: { type: "spring", stiffness: 300, damping: 15 },
              }}
            >
              {item.type === "video" ? (
                <video
                  src={item.src}
                  className={`w-full h-auto block ${
                    isSpecial ? "object-contain max-h-[80vh]" : "object-contain"
                  }`}
                  autoPlay
                  loop
                  muted
                  playsInline
                  onError={() => setHasError(true)}
                />
              ) : (
                <img
                  src={item.src}
                  alt={item.filename}
                  className={`w-full h-auto block transition-opacity duration-300 ${
                    isSpecial
                      ? "object-contain max-h-[80vh]"
                      : "object-contain opacity-90 hover:opacity-100"
                  }`}
                  loading="lazy"
                  onError={(e) => {
                    setHasError(true);
                    e.target.style.display = "none";
                    e.target.parentElement.innerHTML += `<div class="h-24 bg-gray-900/50 flex items-center justify-center text-xs text-gray-700">Img Error</div>`;
                  }}
                />
              )}

              {/* Special Label */}
              {isSpecial && (
                <div className="absolute bottom-6 left-0 w-full text-center pointer-events-none">
                  <span className="text-gold-400 tracking-[0.5em] text-sm uppercase font-bold drop-shadow-lg bg-black/60 px-6 py-2 rounded-full border border-gold-500/30 backdrop-blur-md">
                    {item.filename.includes("Screenshot")
                      ? "The Beginning"
                      : "The Queen"}
                  </span>
                </div>
              )}

              {/* Fun emoji reactions on hover for regular items */}
              {!isSpecial && (
                <motion.div
                  className="absolute top-2 right-2 text-2xl opacity-0 group-hover:opacity-100"
                  whileHover={{ scale: 1.5, rotate: 20 }}
                >
                  âœ¨
                </motion.div>
              )}
            </motion.div>
          </motion.div>
        );
      };

      const Hero = () => {
        const { scrollY } = useScroll();
        const y = useTransform(scrollY, [0, 500], [0, 200]);
        const opacity = useTransform(scrollY, [0, 400], [1, 0]);
        const scale = useTransform(scrollY, [0, 500], [1, 1.1]);

        return (
          <div className="relative h-[90vh] w-full flex flex-col items-center justify-center overflow-hidden">
            <motion.div
              style={{ y, scale, opacity }}
              className="absolute inset-0 z-0"
            >
              <video
                src={`${BASE_PATH}a4.MOV`}
                className="w-full h-full object-cover object-center brightness-[0.4]"
                autoPlay
                loop
                muted
                playsInline
                onError={(e) => {
                  e.target.style.display = "none";
                  e.target.parentNode.style.backgroundColor = "#111";
                }}
              />
            </motion.div>

            <div className="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-[#050505] z-10" />

            <motion.div
              style={{ y: useTransform(scrollY, [0, 300], [0, -50]), opacity }}
              className="relative z-20 text-center px-4"
            >
              <motion.div
                initial={{ scale: 0.8, opacity: 0 }}
                animate={{ scale: 1, opacity: 1 }}
                transition={{ duration: 1.2, ease: "easeOut" }}
              >
                <h1 className="text-7xl md:text-[10rem] font-light tracking-tighter serif text-transparent bg-clip-text bg-gradient-to-b from-white via-gray-200 to-gray-500 mb-2 drop-shadow-2xl">
                  24
                </h1>
              </motion.div>

              <motion.p
                initial={{ y: 20, opacity: 0 }}
                animate={{ y: 0, opacity: 1 }}
                transition={{ delay: 0.5, duration: 0.8 }}
                className="text-xl md:text-2xl tracking-[0.8em] text-gold-400 uppercase font-light"
              >
                JaoMao
              </motion.p>
            </motion.div>

            <div className="absolute bottom-10 z-20 animate-bounce text-white/30">
              <svg
                className="w-6 h-6"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth="2"
                  d="M19 14l-7 7m0 0l-7-7m7 7V3"
                ></path>
              </svg>
            </div>
          </div>
        );
      };

      const App = () => {
        const [hideBroken, setHideBroken] = useState(false);
        const { scrollYProgress } = useScroll();

        // Velocity effect for the whole container
        const scrollVelocity = useVelocity(scrollYProgress);
        const skew = useTransform(
          useSpring(scrollVelocity, { stiffness: 100, damping: 30 }),
          [-1, 1],
          [-2, 2]
        );

        // 1. Find special photos
        const specialPhoto1 = ITEMS.find(
          (item) => item.filename === "hbd24.PNG"
        );
        const specialPhoto2 = ITEMS.find((item) =>
          item.filename.includes("Screenshot 2025-08-27")
        );
        const specialPhotos = [specialPhoto1, specialPhoto2].filter(Boolean);

        // 2. Filter remaining
        const remainingItems = ITEMS.filter(
          (item) => !specialPhotos.includes(item)
        );

        // 3. Distribute
        const splitIndex = Math.floor(remainingItems.length * 0.6);
        const gridItems1 = remainingItems.slice(0, splitIndex);
        const marqueeItems1 = remainingItems.slice(splitIndex, splitIndex + 10);
        const marqueeItems2 = remainingItems.slice(
          splitIndex + 10,
          splitIndex + 20
        );
        const gridItems2 = remainingItems.slice(splitIndex + 20);

        // --- Auto Scroll Logic ---
        useEffect(() => {
          let animationFrameId;
          const autoScroll = () => {
            window.scrollBy(0, 1.5); // Slightly faster for fun
            animationFrameId = requestAnimationFrame(autoScroll);
          };
          animationFrameId = requestAnimationFrame(autoScroll);
          return () => cancelAnimationFrame(animationFrameId);
        }, []);

        return (
          <GalleryContext.Provider value={{ hideBroken, setHideBroken }}>
            <div className="bg-[#050505] min-h-screen text-white/90 selection:bg-gold-500/30 selection:text-white overflow-hidden">
              <div className="grain-overlay" />
              <CustomCursor />

              {/* Cosmic Particle Background */}
              <div className="fixed inset-0 pointer-events-none z-0">
                {/* Generate some static stars/dust */}
                {[...Array(30)].map((_, i) => (
                  <motion.div
                    key={i}
                    className="absolute rounded-full bg-white"
                    style={{
                      width: Math.random() * 3 + "px",
                      height: Math.random() * 3 + "px",
                      top: Math.random() * 100 + "%",
                      left: Math.random() * 100 + "%",
                      opacity: Math.random() * 0.5,
                    }}
                    animate={{
                      y: [0, -30, 0],
                      opacity: [0.2, 0.8, 0.2],
                    }}
                    transition={{
                      duration: Math.random() * 5 + 3,
                      repeat: Infinity,
                      ease: "easeInOut",
                    }}
                  />
                ))}
                <div className="absolute top-[-10%] right-[-10%] w-[40vw] h-[40vw] bg-purple-900/20 rounded-full blur-[100px] mix-blend-screen animate-pulse" />
                <div className="absolute bottom-[-10%] left-[-10%] w-[40vw] h-[40vw] bg-blue-900/10 rounded-full blur-[100px] mix-blend-screen animate-pulse" />
              </div>

              <Hero />

              {/* Warping Container */}
              <motion.div style={{ skewY: skew, transformOrigin: "center" }}>
                {/* Section 1: Asteroid Grid */}
                <div className="relative z-10 max-w-[1900px] mx-auto px-4 py-20">
                  <div className="columns-2 md:columns-3 lg:columns-4 xl:columns-5 gap-8 space-y-8">
                    {gridItems1.map((item) => (
                      <MediaItem key={item.id} item={item} />
                    ))}
                  </div>
                </div>

                {/* Section 2: Hyperspeed Marquees */}
                <div className="relative z-20 py-32 my-10 bg-gradient-to-b from-[#050505] via-[#0a0a0a] to-[#050505] border-y border-white/5">
                  <div className="absolute left-0 top-1/2 -translate-y-1/2 w-full h-[1px] bg-white/10" />
                  <p className="text-center text-xs tracking-[0.5em] text-white/40 mb-12 uppercase animate-pulse">
                    Time Flies With You
                  </p>

                  <div className="rotate-1 scale-110 origin-center hover:scale-100 transition-transform duration-1000">
                    <InfiniteMarquee
                      items={marqueeItems1}
                      direction={-1}
                      speed={0.8}
                    />
                    <div className="h-8" />
                    <InfiniteMarquee
                      items={marqueeItems2}
                      direction={1}
                      speed={0.6}
                    />
                  </div>
                </div>

                {/* Section 3: The Crown Jewels (Highlight) */}
                <div className="relative z-10 max-w-[1600px] mx-auto px-6 py-20">
                  {/* Special Photo Slots */}
                  <div className="mb-20 flex flex-col md:flex-row justify-center items-center gap-12">
                    {specialPhotos.map((photo, i) => (
                      <motion.div
                        key={photo.id}
                        className="w-full max-w-xl"
                        initial={{ y: 100, opacity: 0 }}
                        whileInView={{ y: 0, opacity: 1 }}
                        transition={{ delay: i * 0.2 }}
                      >
                        <MediaItem item={photo} isSpecial={true} />
                      </motion.div>
                    ))}
                  </div>

                  <div className="columns-2 md:columns-4 gap-8 space-y-8">
                    {gridItems2.map((item) => (
                      <MediaItem key={item.id} item={item} />
                    ))}
                  </div>
                </div>
              </motion.div>

              {/* Footer */}
              <footer className="relative z-10 py-48 flex flex-col items-center justify-center text-white/30">
                <div className="w-[1px] h-32 bg-gradient-to-b from-white/20 to-transparent mb-8" />
                <p className="text-xs tracking-[0.5em] uppercase hover:text-gold-500 transition-colors cursor-default">
                  Fin
                </p>
              </footer>
            </div>
          </GalleryContext.Provider>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById("root"));
      root.render(<App />);
    </script>
  </body>
</html>
